# Coffee-house

Этот проект представляет собой систему управления заказами в кофейне, 
построенную на микросервисной архитектуре.
Основная цель — автоматизировать процесс создания заказов,
их обработку бариста, отправку уведомлений и мониторинг статуса.

Сервисы:
1) Order Service (порт 50051): gRPC-сервер для создания заказов и получения статуса. При создании заказа отправляет сообщение в Kafka.
2) Barista Service (порт 50052): gRPC-сервер для управления процессом приготовления.
3) Notification Service (порт 50053): gRPC-сервер для уведомлений и хранения истории.
4) API Gateway (порт 8080): HTTP-сервер, который подключается к другим сервисам via gRPC и предоставляет RESTful endpoints.
5) Kafka: Брокер сообщений для асинхронной обработки.

Заказы (Orders)

`POST /orders/create` - Создает новый заказ.

Тело запроса:
```
json{
    "user_id": "string",  // ID пользователя 
    "item": "string",     // Название изделия (например, "latte")
    "quantity": int       // Количество
}
```
Ответ:
```
json{
    "order_id": "string",  // ID созданного заказа
    "status": "pending"    // Начальный статус
}
```
После создания отправляется событие в Kafka для дальнейшей обработки.

Бариста (Barista)

`POST /barista/start/:order_id` - Начинает приготовление заказа по указанному ID.

Параметры: :order_id — ID заказа.

Ответ:
```
json{
    "status": "preparing"  // Новый статус заказа
}
```
`POST /barista/ready/:order_id` - Отмечает заказ как готовый.

Параметры: :order_id — ID заказа.

Ответ:
```
json{
    "status": "ready"  // Новый статус заказа
}
```


`GET /barista/pending` - Возвращает список ожидающих (pending) заказов.

Ответ: Массив заказов в формате:
```
json[
    {
    "order_id": "string",
    "item": "string",
    "quantity": int,
    "status": "pending"
    },
    ...
]
```

Уведомления (Notifications)

`GET /notifications/` - Возвращает список отправленных уведомлений (с опциональным фильтром по дате).

Параметры запроса: since — дата в формате RFC3339 (опционально, для фильтра с этой даты).

Ответ: Массив уведомлений в формате:
```
json{
    "notifications": [
        {
        "order_id": "string",
        "item": "string",
        "status": "string",
        "timestamp": "string"  // Время отправки
        },
        ...
    ]
}
```

`POST /notifications/manual` - Триггерит ручное уведомление.

Тело запроса:
```
json{
    "order_id": "string",
    "item": "string",
    "status": "string"  // Статус для уведомления
}
```
Ответ:
```
json{
    "status": "sent"  // Успешная отправка
}
```

Уведомление сохраняется в хранилище и отправляется.